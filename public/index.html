<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hospital Management System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  >
  <link rel="stylesheet" href="style.css">

</head>

<body>
  <div id="header"></div>

  <div class="container mt-4">

    <!-- ADD PATIENT FORM -->
    <div class="card p-4 mb-4">
      <h5>Add Patient</h5>
  
      <div class="row g-2">
        <div class="col-md-4">
          <input id="name" class="form-control" placeholder="Name">
        </div>
        <div class="col-md-4">
          <input id="age" type="number" class="form-control" placeholder="Age">
        </div>
        <div class="col-md-4">
          <select id="gender" class="form-control">
            <option value="">Select Gender</option>
            <option>Male</option>
            <option>Female</option>
            <option>Other</option>
          </select>
        </div>
      </div>
  
      <button onclick="addPatient()" class="btn btn-primary mt-3">
        Add Patient
      </button>
  
      <a href="/dashboard" class="btn btn-secondary mt-3 ms-2">
        Back
      </a>
    </div>
  
    <!-- PATIENT LIST -->
    <div class="row" id="patients"></div>
  
  </div>
</div>

<!-- HEADER -->
<script>
  fetch("header.html")
    .then(res => res.text())
    .then(html => document.getElementById("header").innerHTML = html);
</script>
<script>
  async function loadPatients() {
    const res = await fetch('/api/mobile/patients');
    const data = await res.json();
  
    const container = document.getElementById('patients');
    container.innerHTML = '';
  
    data.patients.forEach(p => {
      container.innerHTML += `
        <div class="col-md-4 col-sm-6 mb-3">
          <div class="card p-3 shadow-sm">
            <h6>${p.name}</h6>
            <p class="mb-1">Age: ${p.age}</p>
            <p class="mb-0">Gender: ${p.gender}</p>
          </div>
        </div>
      `;
    });
  }
  
  async function addPatient() {
    const name = document.getElementById('name').value;
    const age = document.getElementById('age').value;
    const gender = document.getElementById('gender').value;
  
    if (!name || !age || !gender) {
      alert('Fill all fields');
      return;
    }
  
    const res = await fetch('/api/mobile/patients', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name, age, gender })
    });
  
    const data = await res.json();
  
    if (data.success) {
      document.getElementById('name').value = '';
      document.getElementById('age').value = '';
      document.getElementById('gender').value = '';
      loadPatients();
    } else {
      alert('Error adding patient');
    }
  }
  
  loadPatients();
  </script>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
  </html>